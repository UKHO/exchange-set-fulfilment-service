# Recreating IaC

The Bicep files used for deployment were initially created by running `azd infra gen`. They were then manually edited.

If we need to regenerate from scratch again then you can run the `azd regenerate.cmd` script in the AppHost project. Afterwards the following updates need to be done:

1. `efs-cae.module.bicep`
   1. Manually add Aspire resource and hidden title tags to the resources.
   2. Change ```param zoneRedundant``` to be of type ```bool```.
2. `main.bicep`
   1. Add storage name output: ```output EFS_STORAGE_NAME string = efs_storage.outputs.name```
   2. Rename the resource group to ```efs-${environmentName}-rg```.
   3. Change ```param zoneRedundant``` to be of type ```bool```.
3. `efs-builder-s100` Restore the deleted bicep and bicepparam files for the builder. These were manually created and won't be generated by azd.
4. Add hidden title tags to the following resources:
   - `efs-orchestrator-identity`
5. Replace underscore( _ ) with dash( - ) for name key as Azure does not allow underscores in resource names:
   - `efs-events-namespace`
6. Add hidden title tags to the log analytics workspace of App Insights:
   - `efs-app-insights`